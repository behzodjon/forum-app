(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["ThreadShow"],{"0621":function(t,e,r){var n=r("9e69"),a=r("d370"),o=r("6747"),c=n?n.isConcatSpreadable:void 0;function s(t){return o(t)||a(t)||!!(c&&t&&t[c])}t.exports=s},"087d":function(t,e){function r(t,e){var r=-1,n=e.length,a=t.length;while(++r<n)t[a+r]=e[r];return t}t.exports=r},"099a":function(t,e){function r(t,e,r){var n=r-1,a=t.length;while(++n<a)if(t[n]===e)return n;return-1}t.exports=r},"0b07":function(t,e,r){var n=r("34ac"),a=r("3698");function o(t,e){var r=a(t,e);return n(r)?r:void 0}t.exports=o},"100e":function(t,e,r){var n=r("cd9d"),a=r("2286"),o=r("c1c9");function c(t,e){return o(a(t,e,n),t+"")}t.exports=c},1290:function(t,e){function r(t){var e=typeof t;return"string"==e||"number"==e||"symbol"==e||"boolean"==e?"__proto__"!==t:null===t}t.exports=r},1368:function(t,e,r){var n=r("da03"),a=function(){var t=/[^.]+$/.exec(n&&n.keys&&n.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""}();function o(t){return!!a&&a in t}t.exports=o},"1efc":function(t,e){function r(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e}t.exports=r},"1f6c":function(t,e,r){"use strict";r("b0c0");var n=r("7a23"),a=Object(n["X"])("data-v-1917c214");Object(n["A"])("data-v-1917c214");var o={class:"post-list"},c={key:0,class:"user-info"},s={href:"#",class:"user-name"},i={href:"#"},u={class:"desktop-only text-small"},d={class:"desktop-only text-small"},f={class:"post-content"},p={class:"col-full"},l={key:1},h={class:"post-date text-faded"},b={key:0,class:"edition-info"};Object(n["y"])();var v=a((function(t,e,r,a,v,j){var O=Object(n["F"])("AppAvatarImg"),y=Object(n["F"])("PostEditor"),_=Object(n["F"])("fa"),x=Object(n["F"])("AppDate");return Object(n["x"])(),Object(n["f"])("div",o,[(Object(n["x"])(!0),Object(n["f"])(n["a"],null,Object(n["D"])(r.posts,(function(e){var r;return Object(n["x"])(),Object(n["f"])("div",{class:"post",key:e.id},[j.userById(e.userId)?(Object(n["x"])(),Object(n["f"])("div",c,[Object(n["k"])("a",s,Object(n["K"])(j.userById(e.userId).name),1),Object(n["k"])("a",i,[Object(n["k"])(O,{class:"avatar-large",src:j.userById(e.userId).avatar},null,8,["src"])]),Object(n["k"])("p",u,Object(n["K"])(j.userById(e.userId).postsCount)+" posts",1),Object(n["k"])("p",d,Object(n["K"])(j.userById(e.userId).threadsCount)+" threads",1)])):Object(n["g"])("",!0),Object(n["k"])("div",f,[Object(n["k"])("div",p,[v.editing===e.id?(Object(n["x"])(),Object(n["f"])(y,{key:0,post:e,onSave:j.handleUpdate},null,8,["post","onSave"])):(Object(n["x"])(),Object(n["f"])("p",l,Object(n["K"])(e.text),1))]),e.userId===t.$store.state.auth.authId?(Object(n["x"])(),Object(n["f"])("a",{key:0,onClick:Object(n["W"])((function(t){return j.toggleEditMode(e.id)}),["prevent"]),href:"#",style:{"margin-left":"auto","padding-left":"10px"},class:"link-unstyled",title:"Make a change"},[Object(n["k"])(_,{icon:"pencil-alt"})],8,["onClick"])):Object(n["g"])("",!0)]),Object(n["k"])("div",h,[null!==(r=e.edited)&&void 0!==r&&r.at?(Object(n["x"])(),Object(n["f"])("div",b,"edited")):Object(n["g"])("",!0),Object(n["k"])(x,{timestamp:e.publishedAt},null,8,["timestamp"])])])})),128))])})),j=r("5530"),O=r("c302"),y=r("5502"),_={components:{PostEditor:O["a"]},props:{posts:{required:!0,type:Array}},data:function(){return{editing:null}},computed:{users:function(){return this.$store.state.users.items}},methods:Object(j["a"])(Object(j["a"])({},Object(y["b"])("posts",["updatePost"])),{},{userById:function(t){return this.$store.getters["users/user"](t)},toggleEditMode:function(t){this.editing=t===this.editing?null:t},handleUpdate:function(t){this.updatePost(t.post),this.editing=null}})};_.render=v,_.__scopeId="data-v-1917c214";e["a"]=_},"1fc8":function(t,e,r){var n=r("4245");function a(t,e){var r=n(this,t),a=r.size;return r.set(t,e),this.size+=r.size==a?0:1,this}t.exports=a},2286:function(t,e,r){var n=r("85e3"),a=Math.max;function o(t,e,r){return e=a(void 0===e?t.length-1:e,0),function(){var o=arguments,c=-1,s=a(o.length-e,0),i=Array(s);while(++c<s)i[c]=o[e+c];c=-1;var u=Array(e+1);while(++c<e)u[c]=o[c];return u[e]=r(i),n(t,this,u)}}t.exports=o},2478:function(t,e,r){var n=r("4245");function a(t){return n(this,t).get(t)}t.exports=a},2524:function(t,e,r){var n=r("6044"),a="__lodash_hash_undefined__";function o(t,e){var r=this.__data__;return this.size+=this.has(t)?0:1,r[t]=n&&void 0===e?a:e,this}t.exports=o},"253c":function(t,e,r){var n=r("3729"),a=r("1310"),o="[object Arguments]";function c(t){return a(t)&&n(t)==o}t.exports=c},"28c9":function(t,e){function r(){this.__data__=[],this.size=0}t.exports=r},"2b03":function(t,e){function r(t,e,r,n){var a=t.length,o=r+(n?1:-1);while(n?o--:++o<a)if(e(t[o],o,t))return o;return-1}t.exports=r},"2eaa":function(t,e,r){var n=r("d612"),a=r("8db3"),o=r("5edf"),c=r("7948"),s=r("b047f"),i=r("c584"),u=200;function d(t,e,r,d){var f=-1,p=a,l=!0,h=t.length,b=[],v=e.length;if(!h)return b;r&&(e=c(e,s(r))),d?(p=o,l=!1):e.length>=u&&(p=i,l=!1,e=new n(e));t:while(++f<h){var j=t[f],O=null==r?j:r(j);if(j=d||0!==j?j:0,l&&O===O){var y=v;while(y--)if(e[y]===O)continue t;b.push(j)}else p(e,O,d)||b.push(j)}return b}t.exports=d},"34ac":function(t,e,r){var n=r("9520"),a=r("1368"),o=r("1a8c"),c=r("dc57"),s=/[\\^$.*+?()[\]{}|]/g,i=/^\[object .+?Constructor\]$/,u=Function.prototype,d=Object.prototype,f=u.toString,p=d.hasOwnProperty,l=RegExp("^"+f.call(p).replace(s,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function h(t){if(!o(t)||a(t))return!1;var e=n(t)?l:i;return e.test(c(t))}t.exports=h},3698:function(t,e){function r(t,e){return null==t?void 0:t[e]}t.exports=r},"3b4a":function(t,e,r){var n=r("0b07"),a=function(){try{var t=n(Object,"defineProperty");return t({},"",{}),t}catch(e){}}();t.exports=a},4245:function(t,e,r){var n=r("1290");function a(t,e){var r=t.__data__;return n(e)?r["string"==typeof e?"string":"hash"]:r.map}t.exports=a},"47f5":function(t,e,r){var n=r("2b03"),a=r("d9a8"),o=r("099a");function c(t,e,r){return e===e?o(t,e,r):n(t,a,r)}t.exports=c},"49f4":function(t,e,r){var n=r("6044");function a(){this.__data__=n?n(null):{},this.size=0}t.exports=a},"5c69":function(t,e,r){var n=r("087d"),a=r("0621");function o(t,e,r,c,s){var i=-1,u=t.length;r||(r=a),s||(s=[]);while(++i<u){var d=t[i];e>0&&r(d)?e>1?o(d,e-1,r,c,s):n(s,d):c||(s[s.length]=d)}return s}t.exports=o},"5e2e":function(t,e,r){var n=r("28c9"),a=r("69d5"),o=r("b4c0"),c=r("fba5"),s=r("67ca");function i(t){var e=-1,r=null==t?0:t.length;this.clear();while(++e<r){var n=t[e];this.set(n[0],n[1])}}i.prototype.clear=n,i.prototype["delete"]=a,i.prototype.get=o,i.prototype.has=c,i.prototype.set=s,t.exports=i},"5edf":function(t,e){function r(t,e,r){var n=-1,a=null==t?0:t.length;while(++n<a)if(r(e,t[n]))return!0;return!1}t.exports=r},6044:function(t,e,r){var n=r("0b07"),a=n(Object,"create");t.exports=a},6747:function(t,e){var r=Array.isArray;t.exports=r},"67ca":function(t,e,r){var n=r("cb5a");function a(t,e){var r=this.__data__,a=n(r,t);return a<0?(++this.size,r.push([t,e])):r[a][1]=e,this}t.exports=a},"69d5":function(t,e,r){var n=r("cb5a"),a=Array.prototype,o=a.splice;function c(t){var e=this.__data__,r=n(e,t);if(r<0)return!1;var a=e.length-1;return r==a?e.pop():o.call(e,r,1),--this.size,!0}t.exports=c},"72f0":function(t,e){function r(t){return function(){return t}}t.exports=r},7948:function(t,e){function r(t,e){var r=-1,n=null==t?0:t.length,a=Array(n);while(++r<n)a[r]=e(t[r],r,t);return a}t.exports=r},"79bc":function(t,e,r){var n=r("0b07"),a=r("2b3e"),o=n(a,"Map");t.exports=o},"7a48":function(t,e,r){var n=r("6044"),a=Object.prototype,o=a.hasOwnProperty;function c(t){var e=this.__data__;return n?void 0!==e[t]:o.call(e,t)}t.exports=c},"7b83":function(t,e,r){var n=r("7c64"),a=r("93ed"),o=r("2478"),c=r("a524"),s=r("1fc8");function i(t){var e=-1,r=null==t?0:t.length;this.clear();while(++e<r){var n=t[e];this.set(n[0],n[1])}}i.prototype.clear=n,i.prototype["delete"]=a,i.prototype.get=o,i.prototype.has=c,i.prototype.set=s,t.exports=i},"7c64":function(t,e,r){var n=r("e24b"),a=r("5e2e"),o=r("79bc");function c(){this.size=0,this.__data__={hash:new n,map:new(o||a),string:new n}}t.exports=c},"7ed2":function(t,e){var r="__lodash_hash_undefined__";function n(t){return this.__data__.set(t,r),this}t.exports=n},"85e3":function(t,e){function r(t,e,r){switch(r.length){case 0:return t.call(e);case 1:return t.call(e,r[0]);case 2:return t.call(e,r[0],r[1]);case 3:return t.call(e,r[0],r[1],r[2])}return t.apply(e,r)}t.exports=r},"8db3":function(t,e,r){var n=r("47f5");function a(t,e){var r=null==t?0:t.length;return!!r&&n(t,e,0)>-1}t.exports=a},"8f3b":function(t,e,r){"use strict";r.r(e);r("b0c0");var n=r("7a23"),a={key:0,class:"col-large push-top"},o=Object(n["j"])(" Edit Thread "),c=Object(n["j"])(" By "),s={href:"#",class:"link-unstyled"},i=Object(n["j"])(", "),u=Object(n["j"])(". "),d={style:{float:"right","margin-top":"2px"},class:"hide-mobile text-faded text-small"},f={key:1,class:"text-center",style:{"margin-bottom":"50px"}},p=Object(n["j"])("Sign In"),l=Object(n["j"])(" or "),h=Object(n["j"])("Register"),b=Object(n["j"])(" to reply. ");function v(t,e,r,v,j,O){var y,_,x=Object(n["F"])("router-link"),m=Object(n["F"])("AppDate"),g=Object(n["F"])("post-list"),k=Object(n["F"])("post-editor");return t.asyncDataStatus_ready?(Object(n["x"])(),Object(n["f"])("div",a,[Object(n["k"])("h1",null,[Object(n["j"])(Object(n["K"])(O.thread.title)+" ",1),O.thread.userId===(null===(y=t.authUser)||void 0===y?void 0:y.id)?(Object(n["x"])(),Object(n["f"])(x,{key:0,to:{name:"ThreadEdit",id:this.id},class:"btn-green btn-small",tag:"button"},{default:Object(n["T"])((function(){return[o]})),_:1},8,["to"])):Object(n["g"])("",!0)]),Object(n["k"])("p",null,[c,Object(n["k"])("a",s,Object(n["K"])(null===(_=O.thread.author)||void 0===_?void 0:_.name),1),i,Object(n["k"])(m,{timestamp:O.thread.publishedAt},null,8,["timestamp"]),u,Object(n["k"])("span",d,Object(n["K"])(O.thread.repliesCount)+" "+Object(n["K"])(1===O.thread.repliesCount?"reply":"replies")+" by "+Object(n["K"])(O.thread.contributorsCount)+" "+Object(n["K"])(1===O.thread.contributorsCount?"contributor":"contributors"),1)]),Object(n["k"])(g,{posts:O.threadPosts},null,8,["posts"]),t.authUser?(Object(n["x"])(),Object(n["f"])(k,{key:0,onSave:O.addPost},null,8,["onSave"])):(Object(n["x"])(),Object(n["f"])("div",f,[Object(n["k"])(x,{to:{name:"SignIn",query:{redirectTo:t.$route.path}}},{default:Object(n["T"])((function(){return[p]})),_:1},8,["to"]),l,Object(n["k"])(x,{to:{name:"Register",query:{redirectTo:t.$route.path}}},{default:Object(n["T"])((function(){return[h]})),_:1},8,["to"]),b]))])):Object(n["g"])("",!0)}r("99af"),r("4de4"),r("d81d"),r("96cf");var j=r("1da1"),O=r("5530"),y=r("1f6c"),_=r("c302"),x=r("5502"),m=r("cae2"),g=r("08b7"),k=r("ceac"),w=r.n(k),I={name:"ThreadShow",components:{PostList:y["a"],PostEditor:_["a"]},mixins:[m["a"]],props:{id:{required:!0,type:String}},setup:function(){var t=Object(g["a"])(),e=t.addNotification;return{addNotification:e}},computed:Object(O["a"])(Object(O["a"])({},Object(x["c"])("auth",["authUser"])),{},{threads:function(){return this.$store.state.threads.items},posts:function(){return this.$store.state.posts.items},thread:function(){return this.$store.getters["threads/thread"](this.id)},threadPosts:function(){var t=this;return this.posts.filter((function(e){return e.threadId===t.id}))}}),methods:Object(O["a"])(Object(O["a"])(Object(O["a"])(Object(O["a"])({},Object(x["b"])("threads",["fetchThread"])),Object(x["b"])("users",["fetchUsers"])),Object(x["b"])("posts",["fetchPosts","createPost"])),{},{fetchPostsWithUsers:function(t){var e=this;return Object(j["a"])(regeneratorRuntime.mark((function r(){var n,a;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.next=2,e.fetchPosts({ids:t,onSnapshot:function(t){var r,n=t.isLocal,a=t.previousItem;e.asyncDataStatus_ready&&!n&&(null===a||void 0===a||!a.edited||null!==a&&void 0!==a&&null!==(r=a.edited)&&void 0!==r&&r.at)&&e.addNotification({message:"Thread recently updated",timeout:5e3})}});case 2:return n=r.sent,a=n.map((function(t){return t.userId})).concat(e.thread.userId),r.next=6,e.fetchUsers({ids:a});case 6:case"end":return r.stop()}}),r)})))()},addPost:function(t){var e=Object(O["a"])(Object(O["a"])({},t.post),{},{threadId:this.id});this.createPost(e)}}),created:function(){var t=this;return Object(j["a"])(regeneratorRuntime.mark((function e(){var r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.fetchThread({id:t.id,onSnapshot:function(){var e=Object(j["a"])(regeneratorRuntime.mark((function e(r){var n,a,o,c,s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(n=r.isLocal,a=r.item,o=r.previousItem,t.asyncDataStatus_ready&&!n){e.next=3;break}return e.abrupt("return");case 3:if(c=w()(a.posts,o.posts),s=c.length>0,!s){e.next=10;break}return e.next=8,t.fetchPostsWithUsers(c);case 8:e.next=11;break;case 10:t.addNotification({message:"Thread recently updated",timeout:5e3});case 11:case"end":return e.stop()}}),e)})));function r(t){return e.apply(this,arguments)}return r}()});case 2:return r=e.sent,e.next=5,t.fetchPostsWithUsers(r.posts);case 5:t.asyncDataStatus_fetched();case 6:case"end":return e.stop()}}),e)})))()}};I.render=v;e["default"]=I},"93ed":function(t,e,r){var n=r("4245");function a(t){var e=n(this,t)["delete"](t);return this.size-=e?1:0,e}t.exports=a},a454:function(t,e,r){var n=r("72f0"),a=r("3b4a"),o=r("cd9d"),c=a?function(t,e){return a(t,"toString",{configurable:!0,enumerable:!1,value:n(e),writable:!0})}:o;t.exports=c},a524:function(t,e,r){var n=r("4245");function a(t){return n(this,t).has(t)}t.exports=a},b047f:function(t,e){function r(t){return function(e){return t(e)}}t.exports=r},b4c0:function(t,e,r){var n=r("cb5a");function a(t){var e=this.__data__,r=n(e,t);return r<0?void 0:e[r][1]}t.exports=a},bbc0:function(t,e,r){var n=r("6044"),a="__lodash_hash_undefined__",o=Object.prototype,c=o.hasOwnProperty;function s(t){var e=this.__data__;if(n){var r=e[t];return r===a?void 0:r}return c.call(e,t)?e[t]:void 0}t.exports=s},c1c9:function(t,e,r){var n=r("a454"),a=r("f3c1"),o=a(n);t.exports=o},c302:function(t,e,r){"use strict";var n=r("7a23"),a=Object(n["X"])("data-v-048d8a78");Object(n["A"])("data-v-048d8a78");var o={class:"col-full"},c={class:"form-actions"},s={class:"btn-blue"};Object(n["y"])();var i=a((function(t,e,r,i,u,d){var f=Object(n["F"])("AppFormField"),p=Object(n["F"])("VeeForm");return Object(n["x"])(),Object(n["f"])("div",o,[Object(n["k"])(p,{onSubmit:d.save,key:u.formKey},{default:a((function(){return[Object(n["k"])(f,{as:"textarea",name:"text",modelValue:u.postCopy.text,"onUpdate:modelValue":e[1]||(e[1]=function(t){return u.postCopy.text=t}),rows:"10",cols:"30",rules:"required"},null,8,["modelValue"]),Object(n["k"])("div",c,[Object(n["k"])("button",s,Object(n["K"])(r.post.id?"Update Post":"Submit post"),1)])]})),_:1},8,["onSubmit"])])})),u=r("5530"),d={props:{post:{type:Object,default:function(){return{text:null}}}},data:function(){return{postCopy:Object(u["a"])({},this.post),formKey:Math.random()}},methods:{save:function(){this.$emit("save",{post:this.postCopy}),this.postCopy.text="",this.formKey=Math.random()}}};d.render=i,d.__scopeId="data-v-048d8a78";e["a"]=d},c584:function(t,e){function r(t,e){return t.has(e)}t.exports=r},cae2:function(t,e,r){"use strict";e["a"]={data:function(){return{asyncDataStatus_ready:!1}},methods:{asyncDataStatus_fetched:function(){this.asyncDataStatus_ready=!0,this.$emit("ready")}}}},cb5a:function(t,e,r){var n=r("9638");function a(t,e){var r=t.length;while(r--)if(n(t[r][0],e))return r;return-1}t.exports=a},cd9d:function(t,e){function r(t){return t}t.exports=r},ceac:function(t,e,r){var n=r("2eaa"),a=r("5c69"),o=r("100e"),c=r("dcbe"),s=o((function(t,e){return c(t)?n(t,a(e,1,c,!0)):[]}));t.exports=s},d370:function(t,e,r){var n=r("253c"),a=r("1310"),o=Object.prototype,c=o.hasOwnProperty,s=o.propertyIsEnumerable,i=n(function(){return arguments}())?n:function(t){return a(t)&&c.call(t,"callee")&&!s.call(t,"callee")};t.exports=i},d612:function(t,e,r){var n=r("7b83"),a=r("7ed2"),o=r("dc0f");function c(t){var e=-1,r=null==t?0:t.length;this.__data__=new n;while(++e<r)this.add(t[e])}c.prototype.add=c.prototype.push=a,c.prototype.has=o,t.exports=c},d9a8:function(t,e){function r(t){return t!==t}t.exports=r},da03:function(t,e,r){var n=r("2b3e"),a=n["__core-js_shared__"];t.exports=a},dc0f:function(t,e){function r(t){return this.__data__.has(t)}t.exports=r},dc57:function(t,e){var r=Function.prototype,n=r.toString;function a(t){if(null!=t){try{return n.call(t)}catch(e){}try{return t+""}catch(e){}}return""}t.exports=a},dcbe:function(t,e,r){var n=r("30c9"),a=r("1310");function o(t){return a(t)&&n(t)}t.exports=o},e24b:function(t,e,r){var n=r("49f4"),a=r("1efc"),o=r("bbc0"),c=r("7a48"),s=r("2524");function i(t){var e=-1,r=null==t?0:t.length;this.clear();while(++e<r){var n=t[e];this.set(n[0],n[1])}}i.prototype.clear=n,i.prototype["delete"]=a,i.prototype.get=o,i.prototype.has=c,i.prototype.set=s,t.exports=i},f3c1:function(t,e){var r=800,n=16,a=Date.now;function o(t){var e=0,o=0;return function(){var c=a(),s=n-(c-o);if(o=c,s>0){if(++e>=r)return arguments[0]}else e=0;return t.apply(void 0,arguments)}}t.exports=o},fba5:function(t,e,r){var n=r("cb5a");function a(t){return n(this.__data__,t)>-1}t.exports=a}}]);
//# sourceMappingURL=ThreadShow.a0e8708e.js.map