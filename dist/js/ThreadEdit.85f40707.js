(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["ThreadEdit"],{6997:function(t,e,n){"use strict";n.r(e);var r=n("7a23"),a={key:0,class:"col-full push-top"},i=Object(r["j"])(" Editing ");function c(t,e,n,c,s,o){var u=Object(r["F"])("ThreadEditor");return t.asyncDataStatus_ready?(Object(r["x"])(),Object(r["f"])("div",a,[Object(r["k"])("h1",null,[i,Object(r["k"])("i",null,Object(r["K"])(o.thread.title),1)]),Object(r["k"])(u,{title:o.thread.title,text:o.text,onSave:o.save,onCancel:o.cancel,onDirty:e[1]||(e[1]=function(t){return s.formIsDirty=!0}),onClean:e[2]||(e[2]=function(t){return s.formIsDirty=!1})},null,8,["title","text","onSave","onCancel"])])):Object(r["g"])("",!0)}n("96cf");var s=n("1da1"),o=n("5530"),u=n("fc02"),d=n("ce96"),l=n("5502"),h=n("cae2"),f={components:{ThreadEditor:u["a"]},mixins:[h["a"]],props:{id:{type:String,required:!0}},data:function(){return{formIsDirty:!1}},computed:{thread:function(){return Object(d["c"])(this.$store.state.threads.items,this.id)},text:function(){var t=Object(d["c"])(this.$store.state.posts.items,this.thread.posts[0]);return t?t.text:""}},methods:Object(o["a"])(Object(o["a"])(Object(o["a"])({},Object(l["b"])("threads",["fetchThread","updateThread"])),Object(l["b"])("posts",["fetchPost"])),{},{save:function(t){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function n(){var r,a,i;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return r=t.title,a=t.text,n.next=3,e.updateThread({id:e.id,title:r,text:a});case 3:i=n.sent,e.$router.push({name:"ThreadShow",params:{id:i.id}});case 5:case"end":return n.stop()}}),n)})))()},cancel:function(){this.$router.push({name:"ThreadShow",params:{id:this.id}})}}),created:function(){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.fetchThread({id:t.id});case 2:return n=e.sent,e.next=5,t.fetchPost({id:n.posts[0]});case 5:t.asyncDataStatus_fetched();case 6:case"end":return e.stop()}}),e)})))()},beforeRouteLeave:function(){if(this.formIsDirty){var t=window.confirm("Are you sure you want to leave? Unsaved changes will be lost!");if(!t)return!1}}};f.render=c;e["default"]=f},cae2:function(t,e,n){"use strict";e["a"]={data:function(){return{asyncDataStatus_ready:!1}},methods:{asyncDataStatus_fetched:function(){this.asyncDataStatus_ready=!0,this.$emit("ready")}}}},fc02:function(t,e,n){"use strict";var r=n("7a23"),a={class:"btn-group"},i={class:"btn btn-blue",type:"submit",name:"Publish"};function c(t,e,n,c,s,o){var u=Object(r["F"])("AppFormField"),d=Object(r["F"])("VeeForm");return Object(r["x"])(),Object(r["f"])(d,{onSubmit:o.save},{default:Object(r["T"])((function(){return[Object(r["k"])(u,{label:"Title",name:"title",modelValue:s.form.title,"onUpdate:modelValue":e[1]||(e[1]=function(t){return s.form.title=t}),rules:"required"},null,8,["modelValue"]),Object(r["k"])(u,{as:"textarea",label:"Content",name:"text",modelValue:s.form.text,"onUpdate:modelValue":e[2]||(e[2]=function(t){return s.form.text=t}),rules:"required",rows:"8",cols:"140"},null,8,["modelValue"]),Object(r["k"])("div",a,[Object(r["k"])("button",{onClick:e[3]||(e[3]=Object(r["W"])((function(e){return t.$emit("cancel")}),["prevent"])),class:"btn btn-ghost"},"Cancel"),Object(r["k"])("button",i,Object(r["K"])(o.existing?"Update":"Publish"),1)])]})),_:1},8,["onSubmit"])}var s=n("5530"),o={props:{title:{type:String,default:""},text:{type:String,default:""}},data:function(){return{form:{title:this.title,text:this.text}}},computed:{existing:function(){return!!this.title}},methods:{save:function(){this.$emit("clean"),this.$emit("save",Object(s["a"])({},this.form))}},watch:{form:{handler:function(){this.form.title!==this.title||this.form.text!==this.text?this.$emit("dirty"):this.$emit("clean")},deep:!0}}};o.render=c;e["a"]=o}}]);
//# sourceMappingURL=ThreadEdit.85f40707.js.map